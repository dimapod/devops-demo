---
#resource_types:
#- name: packer
#  type: docker-image
#  source:
#    repository: jdub/packer-resource


resources:
- name: resource-app
  type: git
  source:
    uri: https://github.com/dimapod/devops-demo.git


jobs:
- name: job-test-app
  public: true
  serial: true
  plan:
  - get: resource-app
  - task: test
    config:
      platform: linux
      image_resource:
        type: docker-image
        source: {repository: busybox}
      inputs:
        - name: resource-app
      outputs:
        - name: secret
      run:
        path: resource-app/concourse/pipeline/golden-image/generate_secret.sh
    params:
      AWS_ACCESS_KEY_ID: {{s3-access-key-id}}
      AWS_SECRET_ACCESS_KEY: {{s3-secret-access-key}}


